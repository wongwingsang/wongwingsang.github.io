<!DOCTYPE html>
<html>
<head>
	<title>Where am I</title>
	<link rel="stylesheet" type="text/css" href="main.css">
	<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
	
	<a href="index.html">back to HOME</a>
	<h1>Where am I?</h1>

	<button id="find-me">Show my location</button><br/>
	<p id = "status"></p>
	<a id = "map-link" target="_blank"></a><br/>
	<iframe id="map-frame" src="" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe><br/>
	
	

	<script>

		function geoFindMe() {

			const status = document.querySelector('#status');
			const mapLink = document.querySelector('#map-link');

			mapLink.href = '';
			mapLink.textContent = '';

			function success(position) {
				const latitude  = position.coords.latitude;
				const longitude = position.coords.longitude;

				status.textContent = '';
				// mapLink.href = `https://www.openstreetmap.org/#map=18/${latitude}/${longitude}`;
				mapLink.href = `https://www.google.com/maps/place/${latitude},${longitude}`;
				mapLink.textContent = `Latitude: ${latitude} °, Longitude: ${longitude} °`;

				document.getElementById('map-frame').src = "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3689.5469597969436!2d"+longitude+"!3d"+latitude+"!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x0%3A0x548e1065c32a9486!2zMjLCsDIyJzE0LjYiTiAxMTTCsDA3JzU1LjMiRQ!5e0!3m2!1szh-TW!2shk!4v1652980744071!5m2!1szh-TW!2shk";
			}

			function error() {
				status.textContent = 'Unable to retrieve your location';
			}

			if(!navigator.geolocation) {
				status.textContent = 'Geolocation is not supported by your browser';
			} else {
				status.textContent = 'Locating…';
				navigator.geolocation.getCurrentPosition(success, error);
			}

		}

		document.querySelector('#find-me').addEventListener('click', geoFindMe);

	</script>
</body>
</html>